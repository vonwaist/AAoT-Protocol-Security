<?xml version="1.0"?>
<!-- CPSA 2.2.12 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>AAoT Authorization Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 2.2.12&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;AAoT Authorization Protocol&quot;)
(comment &quot;CPSA 2.2.12&quot;)
(comment &quot;All input read from AAoTAuth.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t3">3</a> <a href="#t5">5</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol AAoTAuth basic
  (defrole oem
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (defrole verifier
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (comment &quot;AAoT Authorization Protocol Definition&quot;))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AAoTAuth 0</text>
  </svg></div>

<pre>(defskeleton AAoTAuth
  (vars (nv no text) (crps pufrot data) (idv ido idp name))
  (defstrand verifier 4 (nv nv) (no no) (crps crps) (pufrot pufrot)
    (idv idv) (ido ido) (idp idp))
  (non-orig (privk idv) (privk ido))
  (uniq-orig nv)
  (comment &quot;Authentication from the verifier&apos;s perspective&quot;)
  (traces
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (label 0)
  (unrealized (0 3))
  (origs (nv (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idv nv)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>oem</text>
   </g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AAoTAuth 2 (realized)</text></svg></div>

<pre>(defskeleton AAoTAuth
  (vars (nv no text) (crps pufrot data) (idv ido idp name))
  (defstrand verifier 4 (nv nv) (no no) (crps crps) (pufrot pufrot)
    (idv idv) (ido ido) (idp idp))
  (defstrand oem 4 (nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv)
    (ido ido) (idp idp))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 3) (0 3)))
  (non-orig (privk idv) (privk ido))
  (uniq-orig nv)
  (operation encryption-test (displaced 2 0 verifier 3)
    (enc idv ido nv no idp (privk idv)) (1 2))
  (traces
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv))))
    ((recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (label 2)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((idv idv) (ido ido) (nv nv) (idp idp) (no no) (crps crps)
        (pufrot pufrot))))
  (origs (nv (0 0))))</pre>

<p id="t3">Tree <a href="#top">3</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  </svg></div>

<pre>(defprotocol AAoTAuth basic
  (defrole oem
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (defrole verifier
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (comment &quot;AAoT Authorization Protocol Definition&quot;))</pre>

<p id="k3">Item <a href="#t3">3</a>, Child: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((nv nv) (no no) (idv idv) (ido ido) (idp idp))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>oem</text>
   </g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AAoTAuth 3</text>
  </svg></div>

<pre>(defskeleton AAoTAuth
  (vars (no nv text) (idv ido idp name))
  (defstrand oem 3 (nv nv) (no no) (idv idv) (ido ido) (idp idp))
  (non-orig (privk idv) (privk ido))
  (uniq-orig no)
  (comment &quot;Authentication from the OEM&apos;s perspective&quot;)
  (traces
    ((recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))))
  (label 3)
  (unrealized (0 2))
  (origs (no (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t3">4</a>, Parent: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat ido no)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((nv nv) (no no) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <g><title>((nv nv) (no no) (idv idv) (ido ido) (idp idp))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>oem</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AAoTAuth 4 (realized)</text></svg></div>

<pre>(defskeleton AAoTAuth
  (vars (no nv text) (idv ido idp name))
  (defstrand oem 3 (nv nv) (no no) (idv idv) (ido ido) (idp idp))
  (defstrand verifier 3 (nv nv) (no no) (idv idv) (ido ido) (idp idp))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)))
  (non-orig (privk idv) (privk ido))
  (uniq-orig no)
  (operation encryption-test (added-strand verifier 3)
    (enc idv ido nv no idp (privk idv)) (0 2))
  (traces
    ((recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv)))))
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))))
  (label 4)
  (parent 3)
  (unrealized)
  (shape)
  (maps ((0) ((idv idv) (ido ido) (no no) (idp idp) (nv nv))))
  (origs (no (0 1))))</pre>

<p id="t5">Tree <a href="#top">5</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 154.920' font-size='12.000'>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  </svg></div>

<pre>(defprotocol AAoTAuth basic
  (defrole oem
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (defrole verifier
    (vars (idv ido idp name) (nv no text) (crps pufrot data))
    (trace (send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (comment &quot;AAoT Authorization Protocol Definition&quot;))</pre>

<p id="k5">Item <a href="#t5">5</a>, Children: <a href="#k9">9</a> <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>pufrot</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>pufrot</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>crps</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>crps</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AAoTAuth 5</text>
  </svg></div>

<pre>(defskeleton AAoTAuth
  (vars (nv no text) (crps pufrot data) (idv ido idp name))
  (defstrand verifier 4 (nv nv) (no no) (crps crps) (pufrot pufrot)
    (idv idv) (ido ido) (idp idp))
  (deflistener crps)
  (deflistener pufrot)
  (non-orig (privk idv) (privk ido))
  (uniq-orig nv)
  (comment &quot;Secrecy from the verifier&apos;s perspective&quot;)
  (traces
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))) ((recv crps) (send crps))
    ((recv pufrot) (send pufrot)))
  (label 5)
  (unrealized (0 3))
  (origs (nv (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t5">9</a>, Parent: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <g><title>pufrot</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>pufrot</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>crps</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>crps</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc crps pufrot (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido)) (pubk idv))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idv nv)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>oem</text>
   </g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AAoTAuth 9 (realized)</text></svg></div>

<pre>(defskeleton AAoTAuth
  (vars (nv no text) (crps pufrot data) (idv ido idp name))
  (defstrand verifier 4 (nv nv) (no no) (crps crps) (pufrot pufrot)
    (idv idv) (ido ido) (idp idp))
  (deflistener crps)
  (deflistener pufrot)
  (defstrand oem 4 (nv nv) (no no) (crps crps) (pufrot pufrot) (idv idv)
    (ido ido) (idp idp))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((3 3) (0 3)))
  (non-orig (privk idv) (privk ido))
  (uniq-orig nv)
  (operation encryption-test (displaced 4 0 verifier 3)
    (enc idv ido nv no idp (privk idv)) (3 2))
  (traces
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))) ((recv crps) (send crps))
    ((recv pufrot) (send pufrot))
    ((recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps pufrot
          (enc idv ido nv no idp (hash crps) (hash pufrot) (privk ido))
          (pubk idv)))))
  (label 9)
  (parent 5)
  (unrealized)
  (shape)
  (maps
    ((0 1 2)
      ((idv idv) (ido ido) (nv nv) (crps crps) (pufrot pufrot) (idp idp)
        (no no))))
  (origs (nv (0 0))))</pre>

<p id="k10">Item <a href="#t5">10</a>, Parent: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc crps crps (enc idv ido nv no idp (hash crps) (hash crps) (privk ido)) (pubk idv))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat idv nv)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>crps</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>crps</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc crps crps (enc idv ido nv no idp (hash crps) (hash crps) (privk ido)) (pubk idv))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idp (enc idv ido nv no idp (privk idv)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat ido no)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat idv nv)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot crps) (idv idv) (ido ido) (idp idp))</title>
   <text x='239.880' y='77.460' style='text-anchor: middle;'>oem</text>
   </g>
  <g>
   <title>((nv nv) (no no) (crps crps) (pufrot crps) (idv idv) (ido ido) (idp idp))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>verifier</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AAoTAuth 10 (realized)</text></svg>
 </div>

<pre>(defskeleton AAoTAuth
  (vars (nv no text) (crps data) (idv ido idp name))
  (defstrand verifier 4 (nv nv) (no no) (crps crps) (pufrot crps)
    (idv idv) (ido ido) (idp idp))
  (deflistener crps)
  (defstrand oem 4 (nv nv) (no no) (crps crps) (pufrot crps) (idv idv)
    (ido ido) (idp idp))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 3) (0 3)))
  (non-orig (privk idv) (privk ido))
  (uniq-orig nv)
  (operation encryption-test (displaced 3 0 verifier 3)
    (enc idv ido nv no idp (privk idv)) (2 2))
  (traces
    ((send (cat idv nv)) (recv (cat ido no))
      (send (cat idp (enc idv ido nv no idp (privk idv))))
      (recv
        (enc crps crps
          (enc idv ido nv no idp (hash crps) (hash crps) (privk ido))
          (pubk idv)))) ((recv crps) (send crps))
    ((recv (cat idv nv)) (send (cat ido no))
      (recv (cat idp (enc idv ido nv no idp (privk idv))))
      (send
        (enc crps crps
          (enc idv ido nv no idp (hash crps) (hash crps) (privk ido))
          (pubk idv)))))
  (label 10)
  (parent 5)
  (unrealized)
  (shape)
  (maps
    ((0 1 1)
      ((idv idv) (ido ido) (nv nv) (crps crps) (pufrot crps) (idp idp)
        (no no))))
  (origs (nv (0 0))))</pre>

</body>
</html>
